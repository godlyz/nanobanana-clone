# 🧪 论坛系统 Day 11-17 功能测试清单

**测试日期**: 2025-11-25
**测试范围**: 帖子详情、回复系统、发帖功能、编辑删除功能
**开发服务器**: http://localhost:3000

---

## 📋 快速测试清单

### ✅ 基础功能测试

#### 1. 发帖页面 (`/forum/new`)
- [ ] 访问 http://localhost:3000/forum/new
- [ ] 选择一个分类（点击分类按钮，确认高亮）
- [ ] 输入标题（少于 10 字符时查看错误提示）
- [ ] 输入标题（10-200 字符，查看字数统计）
- [ ] 输入内容（少于 20 字符时查看错误提示）
- [ ] 输入内容（20-10000 字符，查看字数统计）
- [ ] 添加标签（输入标签后按回车或点击"添加"）
- [ ] 移除标签（点击标签上的 X 按钮）
- [ ] 尝试添加超过 5 个标签（应该禁用输入）
- [ ] 点击"取消"按钮（应该返回论坛首页）
- [ ] 提交表单（验证通过后应该跳转到新帖子详情页）

**预期结果**:
- ✅ 分类选择正常，选中后高亮显示
- ✅ 字数统计实时更新
- ✅ 验证错误时显示红色提示
- ✅ 剩余字数 < 20 时红色警告
- ✅ 标签添加/移除正常
- ✅ 表单提交成功后跳转到新帖子

---

#### 2. 帖子详情页 (`/forum/threads/[slug]`)

**前提**: 先通过发帖页面创建一个测试帖子，或访问现有帖子

- [ ] 访问帖子详情页（从论坛首页点击帖子标题）
- [ ] 查看帖子标题、内容、作者信息
- [ ] 查看帖子统计（浏览量、回复数、投票数）
- [ ] 点击"返回论坛"按钮（应该跳转到 `/forum`）
- [ ] 点击帖子的点赞按钮（数字应该 +1）
- [ ] 点击帖子的点踩按钮（数字应该 +1）
- [ ] 查看分类标签（应该显示帖子所属分类）
- [ ] 查看发布时间（应该显示相对时间，如"5分钟前"）
- [ ] 查看状态图标（如果帖子被置顶/加精/锁定）

**预期结果**:
- ✅ 帖子信息完整显示
- ✅ 面包屑导航正常
- ✅ 投票功能正常（本地更新，无需刷新）
- ✅ 统计数据正确显示
- ✅ 时间格式符合语言设置（中文/英文）

---

#### 3. 回复功能

**在帖子详情页测试**:

- [ ] 点击顶部"写回复"按钮（应该显示回复表单）
- [ ] 输入回复内容（少于 10 字符时查看错误提示）
- [ ] 输入回复内容（10-5000 字符，查看字数统计）
- [ ] 点击"取消"按钮（表单应该关闭）
- [ ] 再次点击"写回复"并输入有效内容
- [ ] 点击"发送回复"按钮（应该提交成功）
- [ ] 查看新回复是否显示在回复列表中
- [ ] 查看帖子回复数是否 +1

**预期结果**:
- ✅ 回复表单切换正常
- ✅ 字数验证和统计正常
- ✅ 提交成功后表单关闭
- ✅ 新回复立即显示（无需刷新）
- ✅ 回复数正确更新

---

#### 4. 嵌套回复功能

**在帖子详情页测试**:

- [ ] 找到一个回复，点击"回复"按钮
- [ ] 查看回复表单占位符（应该显示 `@用户名`）
- [ ] 输入回复内容
- [ ] 点击"发送回复"按钮
- [ ] 查看新回复是否显示在回复列表中
- [ ] 点击"取消"按钮（表单应该关闭）

**预期结果**:
- ✅ 嵌套回复表单正确显示
- ✅ 占位符包含被回复用户名
- ✅ 提交成功后表单关闭
- ✅ 新回复显示在列表中

---

#### 5. 回复投票功能

**在帖子详情页测试**:

- [ ] 找到一个回复，点击点赞按钮
- [ ] 查看点赞数是否 +1
- [ ] 点击点踩按钮
- [ ] 查看点踩数是否 +1

**预期结果**:
- ✅ 投票按钮响应正常
- ✅ 投票数实时更新（无需刷新）
- ✅ 提交中按钮禁用（防止重复点击）

---

#### 6. 最佳答案功能

**前提**: 需要登录为帖子作者

- [ ] 作为帖子作者访问自己的帖子
- [ ] 找到一个回复，点击"标记为最佳"按钮
- [ ] 查看该回复是否移动到列表顶部
- [ ] 查看该回复是否有绿色边框 + Star 图标
- [ ] 查看帖子标题是否显示 Star 图标
- [ ] 非作者访问帖子（不应该看到"标记为最佳"按钮）

**预期结果**:
- ✅ 仅帖子作者可以标记最佳答案
- ✅ 最佳答案自动排序到顶部
- ✅ 最佳答案有明显的视觉标记
- ✅ 帖子标题显示 Star 图标

---

#### 7. 举报功能

**在帖子详情页测试**:

- [ ] 点击帖子的"举报"按钮（如果不是作者）
- [ ] 查看控制台日志（应该输出 "Report: {thread_id}"）
- [ ] 点击回复的"举报"按钮（如果不是回复作者）
- [ ] 查看控制台日志（应该输出 "Report: {reply_id}"）
- [ ] 作为作者查看自己的帖子/回复（不应该看到举报按钮）

**预期结果**:
- ✅ 仅非作者可以看到举报按钮
- ✅ 点击举报按钮触发正确的回调
- ✅ 控制台输出正确的 ID

**注意**: 举报功能目前仅输出日志，后续需要实现完整的举报流程

---

### ✅ UI/UX 测试

#### 8. 响应式设计

- [ ] 将浏览器窗口缩小到手机宽度（< 640px）
- [ ] 查看发帖页面分类选择（应该变为 2 列）
- [ ] 查看帖子详情页布局（应该适应小屏幕）
- [ ] 查看回复列表（应该正常换行）
- [ ] 将浏览器窗口放大到桌面宽度（> 768px）
- [ ] 查看发帖页面分类选择（应该变为 3 列）

**预期结果**:
- ✅ 所有页面在不同屏幕尺寸下正常显示
- ✅ 按钮和文本自动换行
- ✅ 没有横向滚动条

---

#### 9. 加载状态

- [ ] 刷新帖子详情页
- [ ] 查看加载时的 Skeleton 占位符
- [ ] 等待数据加载完成
- [ ] 查看完整内容是否正确显示

**预期结果**:
- ✅ 加载时显示 Skeleton 占位符
- ✅ 加载完成后正确显示内容
- ✅ 无闪烁或布局跳动

---

#### 10. 空状态

**创建一个没有回复的新帖子**:

- [ ] 访问帖子详情页
- [ ] 查看回复列表区域
- [ ] 应该显示空状态提示（图标 + 文字）

**预期结果**:
- ✅ 空状态提示清晰易懂
- ✅ 提示文字符合语言设置

---

#### 11. 错误处理

**测试 API 错误**:

- [ ] 访问一个不存在的帖子 slug（如 `/forum/threads/nonexistent`）
- [ ] 查看错误提示
- [ ] 点击"返回论坛"按钮

**预期结果**:
- ✅ 显示友好的错误提示
- ✅ 提供返回论坛的链接
- ✅ 不出现白屏或崩溃

---

### ✅ 双语支持测试

#### 12. 语言切换

- [ ] 切换到中文（在页面右上角语言切换器）
- [ ] 查看所有文本是否变为中文
  - 发帖页面：分类、标题、内容、标签、按钮
  - 帖子详情页：面包屑、投票、回复、举报
  - 回复表单：占位符、按钮、错误提示
- [ ] 切换到英文
- [ ] 查看所有文本是否变为英文

**预期结果**:
- ✅ 所有文本正确切换
- ✅ 时间格式符合语言（"1分钟前" / "1 minute ago"）
- ✅ 字数统计符合语言（"字符" / "chars"）
- ✅ 错误提示符合语言

---

#### 8. 编辑帖子功能（Day 15-17 新增）

**前提**: 需要登录为帖子作者

- [ ] 作为帖子作者访问自己的帖子
- [ ] 点击帖子内容下方的"编辑"按钮
- [ ] 应该跳转到编辑页面 (`/forum/threads/[slug]/edit`)
- [ ] 表单应该预填充现有的标题、内容、分类、标签
- [ ] 修改标题或内容
- [ ] 点击"保存更改"按钮
- [ ] 应该返回帖子详情页，显示更新后的内容
- [ ] 应该显示"已编辑"标记
- [ ] 非作者访问帖子（不应该看到"编辑"按钮）

**预期结果**:
- ✅ 仅帖子作者可以看到编辑按钮
- ✅ 编辑页面权限检查（非作者会被重定向）
- ✅ 表单预填充正确
- ✅ 保存成功后返回详情页
- ✅ 更新时间正确显示

---

#### 9. 删除帖子功能（Day 15-17 新增）

**前提**: 需要登录为帖子作者

- [ ] 作为帖子作者访问自己的帖子
- [ ] 点击帖子内容下方的"删除"按钮（红色）
- [ ] 应该弹出确认对话框
- [ ] 点击"确定"
- [ ] 应该删除帖子并跳转到论坛首页
- [ ] 点击"取消"应该不删除
- [ ] 删除中按钮应该禁用

**预期结果**:
- ✅ 仅帖子作者可以看到删除按钮
- ✅ 删除前有确认对话框
- ✅ 删除成功后跳转到论坛首页
- ✅ 删除中按钮禁用（防止重复点击）

---

#### 10. 编辑回复功能（Day 15-17 新增）

**前提**: 需要登录为回复作者

- [ ] 作为回复作者查看自己的回复
- [ ] 点击回复下方的"编辑"按钮
- [ ] 应该显示内联编辑表单（textarea）
- [ ] 原内容应该预填充在 textarea 中
- [ ] 修改内容
- [ ] 点击"保存"按钮
- [ ] 应该更新回复内容并关闭编辑表单
- [ ] 应该显示"已编辑"标记
- [ ] 点击"取消"应该恢复原内容并关闭表单
- [ ] 非作者查看回复（不应该看到"编辑"按钮）

**预期结果**:
- ✅ 仅回复作者可以看到编辑按钮
- ✅ 内联编辑表单正常工作
- ✅ 保存成功后立即显示新内容（无需刷新）
- ✅ 取消操作正确恢复原内容
- ✅ 更新时间正确显示

---

#### 11. 删除回复功能（Day 15-17 新增）

**前提**: 需要登录为回复作者

- [ ] 作为回复作者查看自己的回复
- [ ] 点击回复下方的"删除"按钮（红色）
- [ ] 应该弹出确认对话框
- [ ] 点击"确定"
- [ ] 应该删除回复并从列表中移除
- [ ] 帖子回复数应该 -1
- [ ] 点击"取消"应该不删除
- [ ] 删除中按钮应该禁用

**预期结果**:
- ✅ 仅回复作者可以看到删除按钮
- ✅ 删除前有确认对话框
- ✅ 删除成功后回复立即从列表中消失（无需刷新）
- ✅ 帖子回复数正确更新
- ✅ 删除中按钮禁用（防止重复点击）

---

## 🐛 已知问题

### 需要实现的功能（后续）

1. **举报功能完整实现**
   - 当前仅输出控制台日志
   - 需要实现举报 API 和审核流程

2. **富文本编辑器**
   - 当前仅支持纯文本
   - 后续考虑 Markdown 或 WYSIWYG 编辑器

5. **图片上传**
   - 当前不支持上传图片
   - 需要集成图片存储服务

---

## 📊 测试报告模板

测试完成后，请填写以下报告：

```
测试人员: _______________
测试时间: _______________
浏览器: _________________ (Chrome/Firefox/Safari/Edge)
操作系统: _______________ (Windows/macOS/Linux)

【通过的测试】(数量: __/16)
- [ ] 1. 发帖页面
- [ ] 2. 帖子详情页
- [ ] 3. 回复功能
- [ ] 4. 嵌套回复功能
- [ ] 5. 回复投票功能
- [ ] 6. 最佳答案功能
- [ ] 7. 举报功能
- [ ] 8. 编辑帖子功能（Day 15-17 新增）
- [ ] 9. 删除帖子功能（Day 15-17 新增）
- [ ] 10. 编辑回复功能（Day 15-17 新增）
- [ ] 11. 删除回复功能（Day 15-17 新增）
- [ ] 12. 响应式设计
- [ ] 13. 加载状态
- [ ] 14. 空状态
- [ ] 15. 错误处理
- [ ] 16. 双语支持

【发现的问题】
1. ___________________________
2. ___________________________
3. ___________________________

【改进建议】
1. ___________________________
2. ___________________________
3. ___________________________
```

---

## 🚀 下一步

测试通过后，建议按以下顺序实施：

1. ✅ **集成认证系统**（已完成）
   - ✅ 创建 useAuth Hook
   - ✅ 获取当前用户 ID
   - ✅ 权限控制逻辑

2. ✅ **实现编辑删除**（已完成 - Day 15-17）
   - ✅ 编辑帖子（独立页面）
   - ✅ 删除帖子（带确认）
   - ✅ 编辑回复（内联表单）
   - ✅ 删除回复（带确认）
   - ✅ 权限控制（仅作者可操作）

3. **举报审核系统**（优先级：中）
   - 举报 API
   - 审核队列（管理员）
   - 处理举报（删除/警告/封禁）

4. **富文本和图片**（优先级：中）
   - Markdown 编辑器
   - 图片上传和展示
   - 代码高亮

5. **通知系统**（优先级：低）
   - 新回复通知
   - @提及通知
   - 最佳答案通知

---

**测试指南生成时间**: 2025-11-25
**开发状态**: ✅ Day 11-17 核心功能完成（含编辑删除）
**下一阶段**: Day 18-20（举报审核系统 + 管理功能）
